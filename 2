library(tidyverse)
library(readr)
library(ggplot2)
library(dplyr)
library(psych)
library(dplyr)
library(ggpubr)
getwd()
trial_data =read.delim("Assignment_dataset (2).txt")
colnames(trial_data)
class(trial_data)
dim(trial_data)
head(trial_data)
tail(trial_data)
attach(trial_data)
names(trial_data)
summary(trial_data)
describe(trial_data)
 # 1.	Is there a statistically significant difference in the expression levels of the 4 immune cell markers pre-treatment and post-treatment (analyze each marker separately)? 

boxplot(IL1B_pre,IL1B_post)
boxplot(CX3CL1_pre, CX3CL1_post)
boxplot(TNFA_pre, TNFA_post)
boxplot(CCL20_pre, CCL20_during)
qqnorm(x =IL1B_pre, y =IL1B_post)
qqnorm(x = CX3CL1_pre, y = CX3CL1_post)
qqnorm(x = TNFA_pre, y = TNFA_post)
qqnorm(x= CCL20_pre, y = CCL20_post)
plot(IL1B_pre, IL1B_post)

shapiro.test(IL1B_post)
shapiro.test(CX3CL1_post)
shapiro.test(TNFA_post)
shapiro.test(CCL20_post)
shapiro.test(IL1B_pre)
shapiro.test(CX3CL1_pre)
shapiro.test(TNFA_pre)
shapiro.test(CCL20_pre)

IL1B_shapiro <- trial_data %>%gather(IL1B, Expression, IL1B_pre, IL1B_post) 
shapiro.test(IL1B_shapiro$Expression)
CX3CL1_shapiro <- trial_data %>%gather(CX3CL1, Expression, CX3CL1_pre, CX3CL1_post) 
shapiro.test(CX3CL1_shapiro$Expression)
TNFA_shapiro <- trial_data %>%gather(TNFA, Expression, TNFA_pre, TNFA_post) 
shapiro.test(TNFA_shapiro$Expression)
CCL20_shapiro <- trial_data %>%gather(CCL20, Expression, CCL20_pre, CCL20_post) 
shapiro.test(CCL20_shapiro$Expression)

wilcox.test(IL1B_pre,IL1B_post,paired=TRUE)
wilcox.test(CX3CL1_pre, CX3CL1_post,paired=TRUE)
wilcox.test(TNFA_pre, TNFA_post,paired=TRUE)
wilcox.test(CCL20_pre, CCL20_post,paired=TRUE)

# Is there a significant increase in the number of patient underweight post treatment (classed as a BMI of < 20)? 

shapiro.test(BMI_pre_treatment)
shapiro.test(BMI_post_treatment)
